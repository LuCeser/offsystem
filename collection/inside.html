<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="编内 - 个人博客栏目">
    <meta name="author" content="Blog Author">
    <title>编内 - 编外</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/typography.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/components.css">
</head>
<body>
    <header class="site-header" role="banner">
        <div class="container">
            <nav class="main-nav" role="navigation" aria-label="主导航">
                <div class="nav-brand">
                    <a href="../index.html" class="brand-link">编外</a>
                </div>
                <ul class="nav-list">
                    <li><a href="../index.html" class="nav-link">首页</a></li>
                    <li class="nav-dropdown">
                        <a href="#" class="nav-link active">栏目 <span class="dropdown-arrow">▼</span></a>
                        <ul class="dropdown-menu">
                            <li><a href="inside.html" class="dropdown-link active">编内</a></li>
                            <li><a href="outside.html" class="dropdown-link">编外</a></li>
                            <li><a href="weekly.html" class="dropdown-link">周刊</a></li>
                        </ul>
                    </li>
                    <li><a href="../collection/inside.html" class="nav-link">全部文章</a></li>
                    <li><a href="../tags.html" class="nav-link">标签</a></li>
                    <li><a href="../about.html" class="nav-link">关于</a></li>
                </ul>
                <button class="nav-toggle" aria-label="切换导航菜单" aria-expanded="false">
                    <span class="hamburger"></span>
                </button>
            </nav>
        </div>
    </header>

    <main class="main-content" role="main">
        <!-- 面包屑导航 -->
        <div class="container">
            <nav class="breadcrumb" role="navigation" aria-label="面包屑导航">
                <div class="breadcrumb-item">
                    <a href="../index.html" class="breadcrumb-link">首页</a>
                    <span class="breadcrumb-separator">/</span>
                </div>
                <div class="breadcrumb-item">
                    <span class="breadcrumb-current">编内</span>
                </div>
            </nav>
        </div>

        <!-- 栏目头部 -->
        <section class="collection-header">
            <div class="container">
                <div class="collection-hero">
                    <div class="collection-icon">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                            <path d="M2 17l10 5 10-5"></path>
                            <path d="M2 12l10 5 10-5"></path>
                        </svg>
                    </div>
                    <h1 class="collection-title">编内</h1>
                    <p class="collection-description">在系统之内，理解复杂与秩序。</p>
                    <div class="collection-meta">
                        <span class="collection-stat" id="article-count">计算中...</span>
                        <span class="collection-stat" id="tag-count">计算中...</span>
                        <span class="collection-stat" id="last-updated">计算中...</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- 标签过滤 -->
        <section class="collection-filter">
            <div class="container">
                <div class="filter-header">
                    <h3>标签筛选</h3>
                    <button class="filter-toggle" aria-expanded="false">
                        <span class="filter-text">展开筛选</span>
                        <span class="filter-arrow">▼</span>
                    </button>
                </div>
                <div class="filter-tags-container">
                    <div class="filter-tags" id="filter-tags">
                        <!-- 动态生成标签筛选按钮 -->
                    </div>
                </div>
            </div>
        </section>

        <!-- 文章列表 -->
        <section class="collection-articles">
            <div class="container">
                <div class="articles-grid">
                    <article class="article-item" data-tags="网络安全 HTTPS 中间人攻击">
                        <div class="article-content">
                            <div class="article-meta">
                                <time datetime="2020-07-30" class="article-date">2020年7月30日</time>
                                <span class="reading-time">阅读时间 10 分钟</span>
                            </div>
                            <h2 class="article-title">
                                <a href="../articles/mitm.html">御敌于外：配置HSTS防御中间人攻击</a>
                            </h2>
                            <p class="article-excerpt">
                                之前在自己的服务器上架设了博客并发布到了公网，考虑到安全性还特意加了HTTPS支持。稳定运行一段时间之后忽然就无法访问了，浏览器提示重定向次数过多。通过分析nginx日志，发现了一场针对HTTPS重定向的中间人攻击...
                            </p>
                            <div class="article-tags">
                                <span class="tag">网络安全</span>
                                <span class="tag">HTTPS</span>
                                <span class="tag">中间人攻击</span>
                                <span class="tag">HSTS</span>
                                <span class="tag">Nginx</span>
                            </div>
                            <div class="article-footer">
                                <div class="article-author">
                                    <span class="author-name">作者</span>
                                </div>
                                <a href="../articles/mitm.html" class="read-more">继续阅读 →</a>
                            </div>
                        </div>
                    </article>
                </div>

                <!-- 分页导航 -->
                <nav class="pagination" role="navigation" aria-label="文章分页">
                    <ul class="pagination-list">
                        <li class="pagination-item">
                            <span class="pagination-link disabled" aria-label="上一页">
                                <span aria-hidden="true">←</span>
                                上一页
                            </span>
                        </li>
                        <li class="pagination-item">
                            <span class="pagination-link active" aria-label="第1页" aria-current="page">1</span>
                        </li>
                        <li class="pagination-item">
                            <span class="pagination-link disabled" aria-label="下一页">
                                下一页
                                <span aria-hidden="true">→</span>
                            </span>
                        </li>
                    </ul>
                </nav>
            </div>
        </section>
    </main>

    <footer class="site-footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <p class="copyright">&copy; 2024 编外. 保留所有权利。</p>
                <div class="footer-links">
                    <a href="#" class="footer-link" aria-label="RSS订阅">RSS</a>
                    <a href="#" class="footer-link" aria-label="GitHub">GitHub</a>
                    <a href="#" class="footer-link" aria-label="Twitter">Twitter</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="../js/main.js"></script>
    <script>
        // 阅读时间计算函数（基于400字/分钟的平均阅读速度）
        function calculateReadingTime(chineseChars, englishWords) {
            const totalWords = chineseChars + englishWords;
            const readingSpeed = 400; // 中文平均阅读速度：400字/分钟
            const minutes = Math.ceil(totalWords / readingSpeed);
            return minutes;
        }

        // 编内栏目的文章数据（基于实际字数计算）
        const insideArticles = [
            {
                title: "御敌于外：配置HSTS防御中间人攻击",
                url: "../articles/mitm.html",
                date: "2020年7月30日",
                tags: ["网络安全", "HTTPS", "中间人攻击", "HSTS", "Nginx"],
                excerpt: "之前在自己的服务器上架设了博客并发布到了公网，考虑到安全性还特意加了HTTPS支持。稳定运行一段时间之后忽然就无法访问了，浏览器提示重定向次数过多。通过分析nginx日志，发现了一场针对HTTPS重定向的中间人攻击...",
                chineseChars: 1626,
                englishWords: 648,
                readingTime: calculateReadingTime(1626, 648)
            }
        ];

        // 获取所有标签
        function getAllTags() {
            const tags = new Set();
            insideArticles.forEach(article => {
                article.tags.forEach(tag => tags.add(tag));
            });
            return Array.from(tags).sort();
        }

        // 获取最新文章的日期
        function getLatestDate() {
            if (insideArticles.length === 0) return '-';
            const latest = insideArticles.reduce((prev, current) =>
                (new Date(current.date) > new Date(prev.date)) ? current : prev
            );
            return latest.date;
        }

        // 生成标签筛选按钮
        function generateTagButtons() {
            const filterTags = document.getElementById('filter-tags');
            const allTags = getAllTags();

            // 添加"全部"按钮
            let buttonsHtml = '<button class="tag active" data-tag="all">全部</button>';

            // 添加所有标签按钮
            allTags.forEach(tag => {
                buttonsHtml += `<button class="tag" data-tag="${encodeURIComponent(tag)}">${tag}</button>`;
            });

            filterTags.innerHTML = buttonsHtml;
        }

        // 更新统计信息
        function updateStats() {
            const articleCount = document.getElementById('article-count');
            const tagCount = document.getElementById('tag-count');
            const lastUpdated = document.getElementById('last-updated');

            articleCount.textContent = `${insideArticles.length} 篇文章`;
            tagCount.textContent = `${getAllTags().length} 个标签`;
            lastUpdated.textContent = `更新于 ${getLatestDate()}`;
        }

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            generateTagButtons();
            updateStats();
        });
    </script>
</body>
</html>